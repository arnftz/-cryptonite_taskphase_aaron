# Web Exploitaton

## SOAP

### Flag
* flag: picoCTF{XML_3xtern@l_3nt1t1ty_55662c16}
### Thought Process
* the hint showed its an XXE vuln
* so i went to inspect, found the js and html files
* the post link is link of url/data
* also when you press a button, an xml entry is created and the format can be seen in the network tab
* ```<?xml version="1.0" encoding="UTF-8"?><data><ID>1</ID></data>```
* from this i created a payload using chatgpt
* posted it using curl onto the endpoint
### Steps Taken
* inspect the html and js files
* find the endpoint for xml injection
* find template for xml injection
* create a payload similar to input
* deploy payload using curl to the endpoint
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<data>
  <ID>&xxe;</ID>
</data>
```

## Forbidden Paths

### Flag
* flag: picoCTF{7h3_p47h_70_5ucc355_6db46514}
### Thought Process
* some form of a library bs
* they said file is at /usr/share/nginx/html/flag.txt path
* so i put the path in, and they said Not authorized
* i assume this is what i have to break, so lets see what we can do
* according to the challenge, it is filtering absolute file paths, which means i could technically access it through a relative file path
* but how?
* then it clicked, during taskphase one we used to do ../../.., etc to navigate to root
* maybe that could work here
* and it did, i used ../../../../flag.txt
### Steps Taken
* open website
* input ../../../../flag.txt

## cookies

### Flag
* flag: picoCTF{3v3ry1_l0v3s_c00k135_064663be}
### Thought Process
* opened the site, no hints, only the word cookies
* skimmed through the concept, played around with the text box
* under cookies in inspect tab, there is a cookie 'name' with value set to -1
* when i enter snickerdoodle the value is 0
* when i enter chocolate chip the value is 1
* sugar cookies are 7 and gingerbread is 23
* which means there are multiple cookie names associated with a value
* if there was some way i could input the value and get the cookie names, like write a python script that would iterate through all the values from 1 to maybe 50 and get all the names associated with it, i may find the flag
* so basically when i change the value myself, like if i give 1 in the inspect tab and refresh the page, it automatically changes to chocolate chip (the custom message)
* so my theory of writing a simple python requests script is the way to go
* i ran the script, it needed a litte tweaking and help from chatgpt cause i didnt know how to send cookie payloads but it worked and i found the flag 
### Steps Taken
* run python script
```py
import requests
for i in range(50):
    cookie = f'name={i}'
    headers = {'Cookie':cookie}
    r = requests.get('http://mercury.picoctf.net:27177/check', headers=headers)
    if 'picoCTF' in r.text:
        print(r.text)
```

